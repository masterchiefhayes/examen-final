<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Categorías</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<script src="app.js"></script>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
  <a class="navbar-brand" href="index.html">Inicio</a>
  <a class="nav-link text-light" href="categorias.html">Categorías</a>
  <a class="nav-link text-light" href="productos.html">Productos</a>
  <a class="nav-link text-light" href="creditos.html">Créditos</a>
</nav>

<div class="container mt-4">
  <h1>Categorías</h1>

  <h3>Agregar categoría</h3>
  <form id="formCat" class="mb-4">
    <input class="form-control mb-2" placeholder="Nombre" id="nombreCat" required>
    <input class="form-control mb-2" placeholder="Descripción" id="descCat" required>
    <button class="btn btn-primary">Guardar</button>
  </form>

  <h3>Listado</h3>
  <table class="table table-bordered table-striped">
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Descripción</th>
        <th>Editar</th>
        <th>Eliminar</th>
      </tr>
    </thead>
    <tbody id="tablaCat"></tbody>
  </table>
</div>

<script>
function cargarCategorias() {
  const tbody = document.getElementById("tablaCat");
  tbody.innerHTML = "";
  const cats = JSON.parse(localStorage.getItem("categorias") || "[]");

  cats.forEach(cat => {
    const tr = document.createElement("tr");

    const tdNombre = document.createElement("td");
    tdNombre.innerText = cat.nombre;

    const tdDesc = document.createElement("td");
    tdDesc.innerText = cat.descripcion;

    const tdEditar = document.createElement("td");
    const btnEditar = document.createElement("button");
    btnEditar.className = "btn btn-sm btn-warning";
    btnEditar.innerText = "Editar";
    btnEditar.onclick = () => {
      const nuevoNombre = prompt("Nuevo nombre:", cat.nombre);
      if(nuevoNombre === null) return;
      const nuevaDesc = prompt("Nueva descripción:", cat.descripcion);
      if(nuevaDesc === null) return;
      cat.nombre = nuevoNombre.trim();
      cat.descripcion = nuevaDesc.trim();
      localStorage.setItem("categorias", JSON.stringify(cats));
      cargarCategorias();
    };
    tdEditar.appendChild(btnEditar);

    const tdEliminar = document.createElement("td");
    const btnEliminar = document.createElement("button");
    btnEliminar.className = "btn btn-sm btn-danger";
    btnEliminar.innerText = "Eliminar";
    btnEliminar.onclick = () => {
      const index = cats.findIndex(c => c.id === cat.id);
      if(index > -1) cats.splice(index, 1);
      localStorage.setItem("categorias", JSON.stringify(cats));
      cargarCategorias();
    };
    tdEliminar.appendChild(btnEliminar);

    tr.appendChild(tdNombre);
    tr.appendChild(tdDesc);
    tr.appendChild(tdEditar);
    tr.appendChild(tdEliminar);

    tbody.appendChild(tr);
  });
}

document.getElementById("formCat").addEventListener("submit", e=>{
  e.preventDefault();
  const nombre = document.getElementById("nombreCat").value.trim();
  const desc = document.getElementById("descCat").value.trim();
  if(!nombre || !desc) return alert("Completa todos los campos");
  const cats = JSON.parse(localStorage.getItem("categorias") || "[]");
  cats.push({id: Date.now(), nombre, descripcion: desc});
  localStorage.setItem("categorias", JSON.stringify(cats));
  e.target.reset();
  cargarCategorias();
});

cargarCategorias();
</script>

</body>
</html>
